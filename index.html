<!DOCTYPE html>
<html>

<head>
    <meta name="description" content="noise level">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>BIO is noisy</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.4/p5.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.0/addons/p5.sound.min.js"></script>
	<script src="p5.speech.js"></script>
	<style>
	body, html {
	  margin: 0;
	  padding: 0;
	  overflow: hidden;
	}
	</style>
</head>

<body>
</body>
<script>
	messages = [
		"Shut Up",
		"Shush",
		"I will give ten dollars keep quiet",
		"Is there any point for this?",
		"Is there any mental asylum",
		"I am sorry I asked you",
		"Okay I get it",
		"OMG! Stop Taking!",
		"I hope you get cramp in your tongue",
		"Do you have cheek bones?",
		"The power of Christ compels you.",
		"Be Quiet.",
		"Shut your mouth",
		"Cut it out",
		"Shut your pie hole",
		"Just knock it off?",
		"Blah Blah Blah and Blah-Blah",
		"Oh! This history class.",
		"Shut your yappers",
		"Zip it",
		"Silence`",
		"Have I annoyed you before?",
		"You have a problem...",
		"What kind of noise? Is this?",
		"Where is the remote? I forgot to press mute",
		"Do you talk when you sleep?",
		"I also got constitutional right to speak.",
		"A year later…",
		"Seriously, tell this to some body else!",
		"Oh No! I missed Charlie Chaplin movie.",
		"Shut your beak!",
		"Do you wanna eat?",
		"I am going to kick you if you don’t shut up",
		"That’s why I do watch daily soaps.",
		"You are wasting my time!",
		"Besides Talking! What actually you do?",
		"I would like to throw my shoe at you if you don't stop talking!",
		"So, Have you planned this already?",
		"Your hurting my ears!",
		"Shut that hole in your face!",
		"Is possible to shut your mouth, even for two seconds?",
		"Your dad's the energizer bunny isn't he? Because you are keep talking and talking!",
		"Oh how I wish I were deaf!",
		"My earphone got noise cancellers",
		"Your mom must be so proud of your social skills",
		"Do you like the sound of your on voice?",
		"You are quite a chatter box.",
		"Somebody forget to mute that loudspeaker",
		"My ears are taunting me!",
		"Is that way! You Punish",
		"AHHHHHHHHHHHHHHHHHHHHHHHHH!",
		"Do you breathe?",
		"I'd hate to hear you in your sleep, no offence.",
		"Where is my surgeon knife? I just want to check your vocal chords.",
		"That’s why I read summary in the history book.",
		"Volume needs to go off.",
		"Do me favor! You can do this in front of my enemies.",
		"I wanna paid for this.",
		"Cut the Crap or I will do it for you.",
		"Okay, I love in all, but enough is enough!",
		"Umm, not to be rude, but I really don't care!",
		"I should have brought a blanket.",
		"Do you plan on stopping anytime soon?",
		"At this rate, Haley's comet will be here in no time!",
		"I think you might break the world record for world longest talker!",
		"This is new Gunnies World Record for Talking!",
		"Just stop!",
		"All I hear is jibber jabber!",
		"It just goes in one ear in out the other anyway?",
		"Give me S, Give me H, Give me U, Give me T and then add UP!",
		"You should get PhD for Talking",
		"Oh how I wish I were deaf!",
		"Oh to be Helen Keller!",
		"Have you drunk magic water?",
		"Is pleading really going to be necessary?",
		"I check is there any remuneration of damage due to constant hearing",
		"Are you practicing for Gold medal in Olympics for Talking?",
		"Can I cut you off right there?",
		"You know I am just going to forget everything anyway right?",
		"I need three tapes to record this much.",
		"Hush up!",
		"Because they don’t make unnecessary noise.",
		"Do you take drugs before you start talking?",
		"These telephone operators talk too much.",
		"I just about enough of your incessant jabbering!",
		"Do you have an off button?",
		"Talk to yourself, not me.",
		"Talk to my hands, not me.",
		"Really? You still want to talk.",
		"Your driving me nuts with all the talky!",
		"How is it humanly possible to talk that much?",
		"I'm sorry what? I routed out the last hour, sorry!",
		"That doesn't mean I am going to waste mine, listening to you!",
		"Could you wrap this up? Please!",
		"I think I hear my mom calling.",
		"Sorry I got call from my Ex.",
		"Happy! Want to say anything more",
		"Stop talking to me! Please! I will do anything.",
		"Do I need to pay ransom? To zip your mouth.",
		"Finished?",
		"That’s it."
	]

	function setup() {
		createCanvas(windowWidth, windowHeight)
	    background("white")
	    stroke("green")
	    strokeWeight(4)
	    mic = new p5.AudioIn()
	    mic.start()
	    dataPoints = []
	    buffer = []
	    lastPoint = 0
	    UNIT_SIZE = 2
	    UNIT_NUMBER = 1500
		myVoice = new p5.Speech()
		hasSpokenRecently = false

		THRESHOLD = 300
	}

	function draw() {
		ambient_sound_level = mic.getLevel() * 1000
		if (ambient_sound_level > THRESHOLD) {
			if (!hasSpokenRecently) {
				myVoice.speak(random(messages))
				hasSpokenRecently = true

				setTimeout(function(){ hasSpokenRecently = false }, 3000)
			}
		}
	    buffer.push(Math.round(ambient_sound_level))
	    if (buffer.length == UNIT_SIZE) {
	    	dataPoint = buffer.reduce((a, b) => a + b, 0)
	    	dataPoints.push(dataPoint)
	    	buffer = []
	    }
	    if (dataPoints.length > UNIT_NUMBER) {
	    	dataPoints = dataPoints.slice(dataPoints.length - UNIT_NUMBER)
	    }
	    background("white")
	    for (i = 0; i < UNIT_NUMBER; i += 1) {
	    	if (dataPoints[i] && dataPoints[i - 1]) {
		    	line(
		    		(i - 1) * (width / UNIT_NUMBER),
		    		getYForDataPoint(dataPoints[i - 1]),
		    		(i) * (width / UNIT_NUMBER),
		    		getYForDataPoint(dataPoints[i]),
		    	)
	    	}
	    }
	}

    function getYForDataPoint(dataPoint) {
    	return height - dataPoint / 2
    }
</script>
</html>
